<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta name="description" content="Automated CPU Design by Learning from Input-Output Examples">
  <meta name="keywords" content="Machine Learning">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Automated CPU Design by Learning from Input-Output Examples</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <!-- highlight code -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/atom-one-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script>hljs.highlightAll();</script>


  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">

  <link rel="stylesheet" href="./static/css/bulma.min.css">
  <link rel="stylesheet" href="./static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="./static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="./static/css/fontawesome.all.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="./static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="./static/js/fontawesome.all.min.js"></script>
  <script src="./static/js/bulma-carousel.min.js"></script>
  <script src="./static/js/bulma-slider.min.js"></script>
  <script src="./static/js/index.js"></script>
</head>

<body>
  <!-- 作者 -->
  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Automated CPU Design by Learning from Input-Output Examples
            </h1>
            <div class="is-size-5 publication-authors">
              <span class="author-block">
                <a>Shuyao Cheng</a><sup>1,2,3</sup>,</span>
              <span class="author-block">
                <a>Pengwei Jin</a><sup>1,2,3</sup>,</span>
              <span class="author-block">
                <a>Qi Guo</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a>Zidong Du</a><sup>1,4</sup>,
              </span>
              <span class="author-block">
                <a>Rui Zhang</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a>Xing Hu</a><sup>1,4</sup>,
              </span>
              <span class="author-block">
                <a>Yongwei Zhao</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a>Yifan Hao</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a>Xiangtao Guan</a><sup>5</sup>,
              </span>
              <span class="author-block">
                <a>Husheng Han</a><sup>1,2</sup>,
              </span>
              <span class="author-block">
                <a>Zhengyue Zhao</a><sup>1,2</sup>,
              </span>
              <span class="author-block">
                <a>Ximing Liu</a><sup>1,2</sup>,
              </span>
              <span class="author-block">
                <a>Xishan Zhang</a><sup>1,3</sup>,
              </span>
              <span class="author-block">
                <a>Yuejie Chu</a><sup>1</sup>,
              </span>
              <span class="author-block">
                <a>Weilong Mao</a><sup>1</sup>
              </span>
              <span class="author-block">
                <a>Tianshi Chen</a><sup>3</sup>
              </span>
              <span class="author-block">
                <a>Yunji Chen</a><sup>1,2</sup>
              </span>
            </div>

            <div class="is-size-5 publication-authors">
              <span class="author-block"><sup>1</sup>State Key Lab of Processors, Institute of Computing Technology, Chinese Academy of Sciences</span><br>
              <span class="author-block"><sup>2</sup>University of Chinese Academy of Sciences</span><br>
              <span class="author-block"><sup>3</sup>Cambricon Technologies</span><br>
              <span class="author-block"><sup>4</sup>Shanghai Innovation Center for Processor Technologies</span><br>
              <span class="author-block"><sup>5</sup>University of Science and Technology of China</span><br>
            </div>

            <div class="column has-text-centered">
              <div class="publication-links">
                <!-- PDF Link. -->
                <span class="link-block">
                  <a href="https://www.ijcai.org/proceedings/2024/0425.pdf" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                    </span>
                    <span>PDF</span>
                  </a>
                </span>
                <!-- IJCAI Link.
                <span class="link-block">
                  <a href="https://www.ijcai.org/proceedings/2024/425" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-book"></i>
                    </span>
                    <span>IJCAI</span>
                  </a>
                </span> -->
                <!-- ACM Link. -->
                <span class="link-block">
                  <a href="https://dl.acm.org/doi/10.24963/ijcai.2024/425" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-acm"></i>
                    </span>
                    <span>IJCAI</span>
                  </a>
                </span>
                <!-- Web Link.
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2306.12456" class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="ai ai-arxiv"></i>
                    </span>
                    <span>arXiv</span>
                  </a>
                </span> -->
                <!-- Raw data Link-->
                <!-- <span class="link-block">
                  <a href="https://huggingface.co/yang-z"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-cloud-download-alt"></i>
                    </span>
                    <span>Download</span>
                  </a>
                </span> -->
                <!-- Raw data Link-->
                <!-- <span class="link-block">
                  <a href="https://iprc-dip.github.io/Chip-Design-LLM-Zoo/"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fas fa-trophy"></i>
                    </span>
                    <span>Leaderboard</span>
                  </a>
                </span> -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <!-- Abstract. -->
      <div class="columns is-centered has-text-centered">
        <div class="column is-four-fifths">
          <h2 class="title is-3">Abstract</h2>
          <div class="content has-text-justified">
            <p>
              Designing a central processing unit (CPU) requires intensive manual work by talented experts to implement the circuit logic from design specifications. Although considerable progress has been made in electronic design automation (EDA) to relieve human efforts, all existing tools require hand-crafted formal program codes (e.g., Verilog, Chisel, or C) as the input.
            </p>
            <p>
              To automate CPU design without human programming, we are motivated to learn the CPU design from only input-output (IO) examples, which are generated from test cases of design specification. The key challenge is that the learned CPU design must have near-zero tolerance for inaccuracy, rendering well-known approximate algorithms, such as neural networks, ineffective.
            </p>
            <p>
              We propose a novel AI approach to generate the CPU design as a large-scale Boolean function, using only external IO examples instead of formal program code. This approach employs a new graph structure called the Binary Speculative Diagram (BSD) to accurately approximate the CPU-scale Boolean function. We introduce an efficient BSD expansion method based on <em>Boolean Distance</em>, a new metric to quantitatively measure the structural similarity between Boolean functions, gradually achieving 100% design accuracy.
            </p>
            <p>
              Our approach generates an industrial-scale RISC-V CPU design in just 5 hours, reducing the design cycle by approximately 1000× without human involvement. The taped-out chip, Enlightenment-1, the world's first CPU designed by AI, successfully runs the Linux operating system and performs comparably to the human-designed Intel 80486SX CPU. Remarkably, our approach autonomously rediscovers human knowledge of the von Neumann architecture.
            </p>
          </div>
        </div>
      </div>
      <!--/ Abstract. -->
      <!-- Overview. -->
      <div class="columns is-centered has-text-centered">
        <div class="column">
          <h2 class="title is-3">Overview</h2>
          <div class="content">
            <p>
              We first collect and filter high-quality Verilog modules
              from open-source codebases. The modules are then sent to GPT-3.5 to request multi-level summaries.
              Pairing high-level descriptions with corresponding modules, the high-quality dataset is utilized to
              fine-tune base LLMs, yielding CodeV models.
            </p>
          </div>
          <img src="./static/images/2024ijcai_fig1.png">
        </div>
      </div>
      <!--/ Overview. -->
    </div>
  </section>

  <section class="section">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column">
          <div class="content">
            <h2 class="title is-3">Methodology</h2>
            <p>
              [TODO]
            </p>
            <p>
              [TODO]
            </p>
            <img src="./static/images/multilevel_sum_demo.png">
            </p>
          </div>
        </div>
      </div>

      <div class="columns is-centered">
        <div class="column">
          <div class="content">
            <h2 class="title is-3"> Main Results </h2>
            <p>
              [TODO]
            </p>
            <p>
              [TODO]
            </p>
            <img src="./static/images/result1.png">
            </p>
          </div>
        </div>
      </div>


      <div class="columns is-centered">
        <div class="column">
          <div class="content">
            <h2 class="title is-3"> LLM-generated Verilog code </h2>
            <p>
              [TODO]
            </p>
          </div>
        </div>
      </div>

      <!-- Method -->

      <div class="columns is-centered">
        <div class="column is-full-width">
          <h2 class="title is-3">Quick Start</h2>
          <pre style="width: 100%; overflow: auto; background: none;">
          <code class="python" style="min-width: 100%; width: 0px; overflow: scroll; font-family: 'Cascadia Code', 'Menlo', 'Courier New', monospace;">
from transformers import pipeline
import torch
prompt= "FILL IN THE QUESTION"
generator = pipeline(
  model="CODEV",
  task="text-generation",
  torch_dtype=torch.bfloat16,
  device_map="auto",
)
result = generator(prompt , max_length=2048,num_return_sequences=1, temperature=0.0)
response = result[0]["generated_text"]
print("Response:", response)
            </code>
          </pre>
        </div>
      </div>
    </div>
  
    <!-- <hr/> -->
    <!-- <section class="section" id="BibTeX"> -->
      <!-- <div class="columns is-centered"> -->
        <div class="container content is-max-desktop">
            <h2 class="title is-3"> BibTex </h2>
              <pre>
  <code class="nohighlight" style="background-color: transparent; color: black; font-family: monospace;">@inproceedings{10.24963/ijcai.2024/425,
    author = {Cheng, Shuyao and Jin, Pengwei and Guo, Qi and Du, Zidong and Zhang, Rui and Hu, Xing and Zhao, Yongwei and Hao, Yifan and Guan, Xiangtao and Han, Husheng and Zhao, Zhengyue and Liu, Ximing and Zhang, Xishan and Chu, Yuejie and Mao, Weilong and Chen, Tianshi and Chen, Yunji},
    title = {Automated CPU design by learning from input-output examples},
    year = {2024},
    isbn = {978-1-956792-04-1},
    url = {https://doi.org/10.24963/ijcai.2024/425},
    doi = {10.24963/ijcai.2024/425},
    abstract = {Designing a central processing unit (CPU) requires intensive manual work of talented experts to implement the circuit logic from design specifications. Although considerable progress has been made in electronic design automation (EDA) to relieve human efforts, all existing tools require handcrafted formal program codes (e.g., Verilog, Chisel, or C) as the input. To automate the CPU design without human programming, we are motivated to learn the CPU design from only input-output (IO) examples, which are generated from test cases of design specification. The key challenge is that the learned CPU design should have almost zero tolerance for inaccuracy, which makes well-known approximate algorithms such as neural networks ineffective.We propose a new AI approach to generate the CPU design in the form of a large-scale Boolean function, from only external IO examples instead of formal program code. This approach employs a novel graph structure called Binary Speculative Diagram (BSD) to approximate the CPU-scale Boolean function accurately. We propose an efficient BSD expansion method based on Boolean Distance, a new metric to quantitatively measure the structural similarity between Boolean functions, gradually increasing the design accuracy up to 100\%. Our approach generates an industrial-scale RISC-V CPU design within 5 hours, reducing the design cycle by about 1000\texttimes{} without human involvement. The taped-out chip, Enlightenment-1, the world's first CPU designed by AI, successfully runs the Linux operating system and performs comparably against the human-design Intel 80486SX CPU. Our approach even autonomously discovers human knowledge of the von Neumann architecture.},
    booktitle = {Proceedings of the Thirty-Third International Joint Conference on Artificial Intelligence},
    articleno = {425},
    numpages = {11},
    location = {Jeju, Korea},
    series = {IJCAI '24}
    }</code>
              </pre>
      </div>
      <!-- </section> -->
  </section>

  <!-- <hr/> -->
  

  <footer class="footer">
    <div class="container">
      <div class="columns is-centered">
        <div class="column is-8">
          <div class="content">
            <p>
              This website is licensed under a <a rel="license"
                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
                Commons Attribution-ShareAlike 4.0 International License</a>.
            </p>
            <p>
              Thanks for the website template <a href="https://nerfies.github.io">Nerfies</a>
            </p>
          </div>
        </div>
      </div>
    </div>
  </footer>

</body>

</html>